-
  vpc: ecommerce-vpc
  region: us-south
  classic_access: false
  resource_group: default
  default_network_acl: ecommerce-vpc-acl
  address_prefix:
    -
      name: ecommerce-vpc-zone-1
      zone: us-south-1
      cidr: 172.16.0.0/18
    -
      name: ecommerce-vpc-zone-2
      zone: us-south-2
      cidr: 172.16.64.0/18
    -
      name: ecommerce-vpc-zone-3
      zone: us-south-3
      cidr: 172.16.128.0/18
  zones:
    -
      name: us-south-1
      subnets:
        -
          name: web-tier-us-south-1
          ipv4_cidr_block: 172.16.0.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: web%02d-us-south-1
              quantity: 2
              template: web_server
              floating_ip: true
              security_group: ecommerce-vpc-webtier
              lb_name: ecommerce-vpc-webtier-lb01
              lb_pool: http-app1
              listen_port: 80
        -
          name: app-tier-us-south-1
          ipv4_cidr_block: 172.16.16.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: app%02d-us-south-1
              quantity: 1
              template: app_server
              floating_ip: false
              security_group: ecommerce-vpc-apptier
              lb_name: ecommerce-vpc-apptier-lb01
              lb_pool: http-app1
              listen_port: 80
        -
          name: db-tier-us-south-1
          ipv4_cidr_block: 172.16.32.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: db%02d-us-south-1
              quantity: 1
              template: app_server
              floating_ip: false
              security_group: ecommerce-vpc-dbtier
    -
      name: us-south-2
      subnets:
        -
          name: web-tier-us-south-2
          ipv4_cidr_block: 172.16.64.0/24
          publicGateway: true
          network_acl: ecommerce-vpc-acl
          instances:
            -
              name: web%02d-us-south-2
              quantity: 1
              template: web_server
              floating_ip: true
              security_group: ecommerce-vpc-webtier
              lb_name: ecommerce-vpc-webtier-lb01
              lb_pool: http-app1
              listen_port: 80
        -
          name: app-tier-us-south-2
          ipv4_cidr_block: 172.16.80.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: app%02d-us-south-2
              quantity: 1
              template: app_server
              floating_ip: false
              security_group: ecommerce-vpc-apptier
              lb_name: ecommerce-vpc-apptier-lb01
              lb_pool: http-app1
              listen_port: 80
        -
          name: db-tier-us-south-2
          ipv4_cidr_block: 172.16.96.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: db%02d-us-south-2
              quantity: 1
              template: app_server
              floating_ip: false
              security_group: ecommerce-vpc-dbtier
    -
      name: us-south-3
      subnets:
        -
          name: web-tier-us-south-3
          ipv4_cidr_block: 172.16.128.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: web%02d-us-south-3
              quantity: 1
              template: web_server
              floating_ip: true
              security_group: ecommerce-vpc-webtier
              lb_name: ecommerce-vpc-webtier-lb01
              lb_pool: http-app1
              listen_port: 80
        -
          name: app-tier-us-south-3
          ipv4_cidr_block: 172.16.144.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
            -
              name: app%02d-us-south-3
              quantity: 1
              template: app_server
              floating_ip: false
              security_group: ecommerce-vpc-apptier
              lb_name: ecommerce-vpc-apptier-lb01
              lb_pool: http-app1
              listen_port: 80
        -
          name: db-tier-us-south-3
          ipv4_cidr_block: 172.16.160.0/24
          network_acl: ecommerce-vpc-acl
          publicGateway: true
          instances:
             -
              name: db%02d-us-south-3
              quantity: 1
              template: app_server
              floating_ip: false
              security_group: ecommerce-vpc-dbtier
  load_balancers:
    -
      lbInstance: ecommerce-vpc-webtier-lb01
      is_public: true
      subnets:
        - web-tier-us-south-1
        - web-tier-us-south-2
      listeners:
        -
          protocol: http
          port: 80
          connection_limit: 100
          default_pool_name: http-app1
      pools:
        -
          name: http-app1
          protocol: http
          algorithm: round_robin
          health_monitor:
            type: http
            delay: 5
            max_retries: 2
            timeout: 2
            url_path: /
    -
      lbInstance: ecommerce-vpc-apptier-lb01
      is_public: false
      subnets:
        - app-tier-us-south-1
        - app-tier-us-south-2
      listeners:
        -
          protocol: http
          port: 80
          connection_limit: 100
          default_pool_name: http-app1
      pools:
        - name: http-app1
          protocol: http
          algorithm: round_robin
          health_monitor:
            type: http
            delay: 5
            max_retries: 2
            timeout: 2
            url_path: /
  instanceTemplates:
    -
      template: web_server
      image_id: 7eb4e35b-4257-56f8-d7da-326d85452591
      profile_name: c-2x4
      sshkey_id: 636f6d70-0000-0001-0000-00000014ba47
      cloud-init-file: cloud-init.txt
    -
      template: app_server
      image_id: 7eb4e35b-4257-56f8-d7da-326d85452591
      profile_name: c-8x16
      sshkey_id: 636f6d70-0000-0001-0000-00000014ba47
      cloud-init-file: cloud-init.txt
    -
      template: db_server
      image_id: 7eb4e35b-4257-56f8-d7da-326d85452591
      profile_name: m-32x256
      sshkey_id: 636f6d70-0000-0001-0000-00000014ba47
      cloud-init-file: cloud-init.txt